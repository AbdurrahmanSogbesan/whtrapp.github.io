document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector(".whtrlive"),t=document.querySelector(".today-temperature"),r=document.querySelector(".date"),n=document.querySelector(".time"),o=document.querySelector(".place"),a=document.querySelector(".weather-icon"),c=document.querySelector(".cloudy"),u=document.querySelector(".humidity"),i=document.querySelector(".windspeed"),y=document.querySelector(".precipitation"),s=document.getElementById("locationInput"),l=document.querySelector(".search"),_=document.querySelector(".searchbtn"),d=document.querySelectorAll(".city"),p=document.querySelector(".day"),m=document.querySelector(".sunrise"),h=document.querySelector(".sunset"),g=document.querySelector(".tomorrow-temperature"),$="London";function q(){fetch("../apikey.php").then(e=>e.json()).then(e=>e.api_key).then(s=>{fetch(`http://api.weatherapi.com/v1/current.json?key=${s}&q=${$}&aqi=yes`).then(e=>e.json()).then(l=>{var d,q,b;t.innerHTML=`${l.current.temp_c}&#176;C / ${l.current.temp_f}&#176;F`;let S=l.location.localtime,L=parseInt(S.substr(0,4)),M=parseInt(S.substr(5,2)),k=parseInt(S.substr(8,2)),T=S.substr(11);r.innerHTML=`${function e(t,r,n){let o=new Date(new Date(`${n}-${r}-${t}`));return["January","February","March","April","May","June","July","August","September","October","November","December"][o.getMonth()]}(k,M,L)} ${k}, ${L}`,n.innerHTML=T,p.innerHTML=`${d=k,q=M,b=L,["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date(`${b}-${q}-${d}`).getDay()]}`,theDate=`${L}-${M}-${k}`,o.innerHTML=`<i class="fas fa-location-dot"></i> ${l.location.name}, ${l.location.country}`;let v=l.current.condition.icon.substr(35);a.src="./img/icons/"+v,fetch(`http://api.weatherapi.com/v1/astronomy.json?key=${s}&q=${$}&dt=${theDate}`).then(e=>e.json()).then(e=>{m.innerHTML=`${e.astronomy.astro.sunrise}`,h.innerHTML=`${e.astronomy.astro.sunset}`}),fetch(`http://api.weatherapi.com/v1/forecast.json?key=${s}&q=${$}&days=1&aqi=yes&alerts=no`).then(e=>e.json()).then(e=>{g.innerHTML=`Tomorrow's Temperature: ${e.current.temp_c}&#176;C / ${e.current.temp_f}&#176;F`}),c.innerHTML=l.current.cloud+"%",u.innerHTML=l.current.humidity+"%",i.innerHTML=l.current.wind_kph+"km/h",y.innerHTML=l.current.precip_mm+"mm";let w="day",H=l.current.condition.code;l.current.is_day||(w="night"),1e3==H?e.style.backgroundImage=`url(./img/background/${w}/clear.jpg)`:1003==H||1006==H||1009==H||1030==H||1069==H||1087==H||1135==H||1273==H||1276==H||1279==H||1282==H?e.style.backgroundImage=`url(./img/background/${w}/cloudy.jpg)`:1063==H||1069==H||1072==H||1150==H||1153==H||1180==H||1186==H||1189==H||1192==H||1195==H||1204==H||1207==H||1240==H||1243==H||1246==H||1249==H||1252==H?(e.style.backgroundImage=`url(../img/background/${w}/rainy.jpg)`,_.style.background="#647d75"):e.style.backgroundImage=`url(../img/background/${w}/snowy.jpg)`,e.style.opacity="1"}).catch(()=>{alert("City not found"),e.style.opacity="1"})}).catch(e=>{console.error(e)})}d.forEach(t=>{t.addEventListener("click",t=>{$=t.target.innerHTML,console.log($),q(),e.style.opacity="1"})}),s.addEventListener("submit",t=>{0==l.value.length?alert("Please type a proper City name"):($=l.value,q(),l.value="",e.style.opacity="1"),t.preventDefault()}),q(),e.style.opacity="1"});